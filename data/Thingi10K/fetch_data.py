
"""
Auto-generated download script for Thingi10K dataset.
Assuming the following python packages and external commands are available.

* argparse: for parse command line args.
* requests: for http communication.
* wget: for downloading files.

Usage:

    python Thingi10K_download.py

or

    python Thingi10K_download.py -o output_dir

"""

import argparse
import os.path
import sys
from subprocess import check_call
from tqdm import tqdm

try:
    import requests
except ImportError:
    error_msg = "Missing module: requests.  To fix it, please run '$ pip install requests'";
    sys.exit(error_msg);

# try:
#     check_call("which -s wget".split());
# except:
#     error_msg = "Missing command: wget.  To fix it, please run '$ port install wget'";
#     sys.exit(error_msg);

def parse_args():
    parser = argparse.ArgumentParser(description=__doc__);
    parser.add_argument("--output", "-o", help="Output directory", default="./");
    return parser.parse_args();

def download_file(file_id, output_dir):
    if not os.path.isdir(output_dir):
        raise IOError("Directory {} does not exists".format(output_dir));
    url = "https://www.thingiverse.com/download:{}".format(file_id);
    r = requests.head(url);
    link = r.headers.get("Location", None);
    if link is None:
        print("File {} is no longer available on Thingiverse.".format(file_id));
        return;

    __, ext = os.path.splitext(link);
    output_file = "{}{}".format(file_id, ext.lower());
    output_file = os.path.join(output_dir, output_file);
    print("Downloading {}".format(output_file));
    command = "wget -q -O {} --tries=10 {}".format(output_file, link);
    check_call(command.split());

def main():
    args = parse_args();
    file_ids = [32770,35269,36069,36082,36372,37266,37274,37276,37278,37280,37282,37283,37284,37285,37322,37384,37568,37620,37621,37622,37750,37863,37864,37865,37866,37964,37965,37966,37967,37968,37969,37972,37991,38637,38639,38640,38643,38644,39106,39108,39109,39124,39142,39158,39159,39160,39164,39180,39182,39345,39353,39355,39358,39442,39443,39444,39445,39460,39461,39462,39463,39495,39496,39498,39499,39505,39636,39645,39678,39768,39769,39878,39879,39880,39924,39927,39930,39946,39950,40051,40052,40067,40117,40118,40119,40171,40172,40179,40312,40349,40356,40358,40359,40360,40447,40448,40449,40450,40584,40585,40601,40602,40662,40663,40746,40836,40842,40844,40845,40846,40847,40915,40982,40984,40985,40986,40987,40988,40992,40994,41098,41104,41105,41106,41107,41108,41109,41110,41111,41271,41272,41360,41458,41466,41521,41929,42036,42042,42155,42156,42192,42194,42332,42370,42575,42576,42631,42632,42633,42727,42836,42863,43188,43437,43439,43551,43554,43555,43584,43594,43655,43663,43664,43665,43748,43858,43860,43959,43960,44027,44059,44061,44102,44110,44111,44314,44379,44381,44382,44384,44397,44398,44399,44400,44498,44622,44623,44624,44629,44633,44710,44819,44908,44910,44912,45090,45169,45333,45408,45410,45945,46265,46780,47076,47096,47097,47687,47733,47774,47775,47845,47852,47854,47984,48029,48030,48031,48132,48270,48367,48368,48551,48552,48557,48558,49160,49315,49316,49317,49318,49375,49376,49382,49383,49544,49545,49549,49794,49860,49902,50112,50283,50307,50308,50649,50704,51009,51010,51011,51012,51013,51014,51015,51016,51139,51140,51141,51142,51643,51647,51654,51660,51700,51806,51807,51809,52070,52071,52072,52073,52074,52075,52135,52136,52137,52138,52139,52140,52141,52409,52562,53404,53405,53406,53427,53429,53435,53439,53748,53749,53750,53835,53858,53890,54161,54162,54212,54215,54470,54471,54674,54757,54759,55039,55177,55354,55410,55426,55427,55428,55429,55448,55506,55536,55932,56047,56094,56265,56497,56498,56524,56592,56630,56735,56892,56988,57081,57082,57083,57084,57085,57140,57178,57179,57180,57181,57331,57416,57420,57656,57657,57658,57659,57713,57714,57896,57897,57908,57909,57937,57942,57945,57948,57993,58035,58070,58238,58395,58439,58564,58886,58938,59125,59126,59127,59128,59197,59333,59340,59703,59704,59705,59706,59708,59709,59710,59747,59752,59764,59766,59767,59769,59770,59771,59942,60100,60246,60328,60364,60507,60513,60550,60554,60843,60844,60845,61083,61193,61583,61585,62286,62287,62288,62415,62570,62571,62880,62989,62991,62992,63245,63461,63462,63466,63474,63497,63556,63709,63871,64578,64579,64821,64957,65143,65144,65149,65394,65400,65414,65444,65504,65588,65604,65607,65608,65609,65610,65611,65612,65614,65615,65616,65617,65618,65619,65754,65755,65757,65758,65779,66478,66480,66483,66484,66486,66566,66678,66773,66783,67334,67408,67497,67516,67524,67889,67890,67919,67923,67924,67925,67926,67927,67928,67929,68199,68215,68216,68255,68371,68372,68380,68381,68382,68416,68454,68455,68501,68649,68661,68706,68935,69056,69057,69058,69089,69090,69091,69092,69257,69264,69399,69402,69403,69404,69405,69406,69689,69705,69928,69930,69931,69979,69980,69981,69982,69983,69984,69985,69986,69987,69988,70060,70114,70369,70371,70373,70376,70377,70379,70559,70829,70830,70831,70832,70833,70834,70835,70836,70837,70838,70839,70840,70922,70944,71041,71046,71260,71261,71264,71265,71266,71307,71328,71461,71462,71709,71761,71762,71763,71764,71999,72094,72095,72107,72158,72189,72190,72191,72203,72224,72225,72286,72317,72318,72320,72321,72326,72327,72329,72330,72332,72333,72581,72613,72665,72666,72881,72896,72960,73081,73082,73083,73084,73085,73086,73088,73089,73090,73153,73154,73155,73158,73265,73266,73268,73269,73271,73428,73432,73435,73464,73739,73764,73934,74150,74151,74154,74157,74448,74449,74454,74455,74461,74462,74471,74600,74659,74690,75106,75113,75114,75115,75116,75117,75118,75133,75142,75359,75361,75496,75622,75623,75651,75652,75653,75654,75656,75657,75658,75659,75660,75665,75667,75845,75848,75893,75894,75977,75984,75991,75993,75994,76053,76056,76057,76143,76202,76539,76573,76579,76682,76683,76684,76755,76756,76947,77011,77013,77014,77015,77016,77017,77019,77020,77021,77472,77474,77926,77927,77928,77929,77930,77937,77938,77939,77940,77941,77943,77944,77945,77946,77947,77948,77949,77950,77951,78319,78324,78350,78481,78733,78736,78737,78738,78970,78976,79076,79177,79183,79189,79190,79191,79193,79195,79200,79202,79357,79428,79741,79810,79851,79936,79938,79939,79940,79960,80084,80086,80353,80354,80356,80357,80361,80363,80364,80366,80368,80369,80370,80414,80516,80597,80603,80604,80746,80748,80750,80757,80759,80769,80908,80939,80941,81129,81130,81131,81132,81133,81137,81145,81147,81148,81150,81152,81162,81181,81209,81307,81368,81369,81589,81636,81919,82058,82059,82170,82326,82379,82380,82407,82471,82526,82675,82803,83002,83167,83720,83835,83855,84022,84320,84321,84512,84639,84640,84641,84642,84930,84943,84975,84987,85112,85440,85580,85659,85758,85774,86160,86163,86164,86240,86242,86848,86849,87355,87521,87599,87601,87602,87687,87688,87689,87690,87721,87825,88572,88991,89266,89448,89449,89911,89912,89913,89914,90064,90088,90089,90223,90224,90226,90279,90280,90281,90282,90432,90434,90435,90437,90736,91007,91142,91347,91350,91351,91352,91353,91354,91355,91606,91655,91656,91657,91658,91904,91915,91917,91918,92116,92118,92119,92422,92668,92832,92837,93067,93068,93069,93070,93071,93072,93073,93101,93107,93108,93109,93130,93543,93545,93547,93549,93551,93553,93554,93556,93989,94139,94144,94146,94147,94148,94149,94150,94152,94153,94155,94156,94157,94158,94662,94664,94665,94667,94668,94669,94674,94675,94733,94736,94886,94990,95037,95180,95185,95488,95489,95776,95779,95794,95798,95800,95801,95807,95808,95810,95811,95812,95813,96046,96069,96123,96450,96456,96543,96583,96752,96771,96778,97172,97489,97490,97494,97503,97507,97511,97512,97590,97593,97596,97597,97599,97843,97854,97859,97939,97940,97941,97942,98009,98012,98017,98019,98020,98021,98163,98412,98413,98479,98480,98517,98518,98625,98651,98763,98765,98767,98935,98938,98939,98940,99265,99267,99269,99270,99272,99275,99276,99467,99468,99469,99897,99900,99910,99911,99912,100339,100340,100342,100343,100344,100345,100349,100388,100423,100643,100646,100894,101089,101340,101342,101558,101582,101619,101620,101634,101635,101636,101864,101865,101902,102255,102257,102375,102625,103141,103143,103284,103286,103289,103356,103357,103519,103537,103538,104400,104401,104402,104403,104404,104431,104442,104445,104639,104640,104737,104738,104930,104968,104969,105171,105338,105348,105413,105637,105687,105688,105695,105696,105761,105762,105765,105803,105875,105924,105925,106037,106090,106146,106368,106558,106559,106681,106777,106778,106779,106780,106781,106782,106783,106784,106785,106786,106787,106788,106789,107007,107148,107295,107389,107390,107391,107392,107402,107434,107438,107445,107558,107586,107909,107910,108293,108578,108579,108620,108693,108858,109014,109015,109021,109375,109458,109459,109572,109575,109576,109772,110009,110025,110026,110027,110028,110029,110030,110031,110047,110132,110353,110357,110358,110444,110445,110715,110792,110793,110795,110796,110801,110803,110905,110909,110980,111008,111009,111013,111240,111394,111878,112539,112541,112544,112546,112835,112965,112998,112999,113125,113126,113127,113128,113221,113341,113342,113343,113418,113419,113420,113866,113867,113868,113869,113891,114020,115053,115423,115532,116065,116066,116069,116070,116072,116076,116078,116292,116294,116295,116872,116878,116890,116891,116893,116896,117523,117949,117952,118032,118034,118290,118292,118293,118297,118299,118301,118302,118304,118306,118309,118317,118768,118904,118909,119238,119247,120755,120756,120789,121394,121395,121397,121398,121399,122349,122351,122551,123472,124034,124035,124036,124038,124039,124040,124041,124358,124360,124361,124363,124371,124373,124375,124535,124707,124708,125947,126195,126660,127243,127889,127891,128329,128350,128640,128915,129914,129915,129918,129920,129929,129930,129973,129975,129978,129979,129992,130001,130014,130015,130017,130206,130441,130960,130961,130962,130964,130967,130969,130973,130975,130977,130978,130979,130980,130986,131090,131091,131453,131727,131969,132062,132349,132421,132424,132434,132438,132441,132450,132536,133077,133078,133079,133275,133276,133568,133582,133991,133992,133993,133994,134543,134630,134631,135062,135065,135066,135077,135216,135363,135364,135365,135493,135806,135807,135808,135810,136024,136243,136397,136404,136523,136634,136636,136638,136639,136935,137976,137977,139764,139765,139767,139934,144106,145329,145330,145352,145419,145495,145496,145503,145504,148293,149255,151360,151376,152773,153956,153960,153963,153968,157174,157812,158249,159695,161091,161093,161459,161461,161717,162282,162335,162340,163758,163763,163764,167109,168074,168076,175915,177007,177008,177009,178196,178340,186199,186200,186201,186202,186203,186204,186541,186545,187279,187280,187281,187282,187284,188496,188497,188498,188499,188500,188501,188503,188504,188506,191077,195680,195696,195697,196190,196193,196207,196208,199818,199819,199820,200003,200004,200005,200011,200074,200075,200076,200077,200078,200079,200080,200081,200082,200083,200212,200369,200683,200684,200685,200689,200690,200691,200692,200693,200694,201962,202265,202266,202267,203217,203280,203281,203289,204243,206462,208367,208632,208741,209086,212135,212136,212138,213385,214249,214251,214252,214479,214480,214904,215991,216761,216762,216763,218729,218730,221686,223146,224026,224829,225354,225937,225939,225940,225946,225949,225951,225952,225954,225961,225965,225967,225973,225978,227387,227388,227615,227616,229598,229604,229605,230909,233186,233187,233188,233189,233190,233191,233192,233193,233194,233195,233196,233197,233198,233199,236171,237183,237623,237624,237626,237634,237735,237736,238638,242225,243661,247069,248185,249518,249519,249521,249522,249523,249524,250739,252614,252631,252632,252634,252635,252636,252637,252638,252640,255172,257594,257881,258879,260541,263198,263199,264707,265473,265592,265728,265730,267784,269800,271301,271303,271304,271305,271868,271870,271872,271873,271874,271876,274379,275400,278455,278456,278458,278461,280278,280280,280281,280282,280283,280285,285606,285607,285610,286161,288349,293137,293452,293453,293454,293455,293457,294160,298321,298592,298593,301920,303901,303902,308214,311329,313873,313875,313877,313878,313879,313881,313882,313883,313884,313917,314438,314439,314440,319831,326895,331045,331105,338509,347932,350277,354371,360006,360067,360070,362964,363534,365170,366726,366727,366956,366957,367343,368147,368148,368891,370212,370217,370517,370886,370988,371103,372053,372054,372055,372056,372057,372058,372059,372090,372114,372602,373702,373705,373706,375065,375081,375237,375239,375240,375241,375244,375251,375252,375254,375256,375258,375259,375264,375266,375267,375268,375269,375270,375271,375273,375277,375280,384086,384087,386839,386841,387872,390936,394203,397011,398304,399899,400236,400237,405822,405887,405889,406449,407639,409624,409625,409629,423825,425600,428603,437375,439141,439142,439143,441616,441617,441618,441708,442383,442384,442388,448014,449817,449906,454346,455436,461109,461110,461111,464843,466802,470464,471983,471984,471985,471986,471988,471990,471992,471994,471995,471996,472001,472008,472011,472016,472017,472018,472020,472023,472028,472031,472033,472035,472036,472038,472041,472044,472049,472051,472053,472054,472055,472056,472057,472058,472059,472061,472062,472063,472064,472068,472069,472070,472072,472073,472074,472075,472077,472078,472079,472081,472084,472085,472086,472087,472089,472092,472093,472094,472097,472100,472102,472105,472106,472108,472112,472113,472114,472115,472117,472121,472122,472123,472124,472125,472130,472131,472132,472133,472134,472135,472137,472138,472140,472141,472142,472143,472144,472145,472146,472147,472148,472149,472150,472155,472156,472157,472158,472159,472160,472161,472162,472163,472164,472165,472167,472168,472169,472174,472175,472180,472186,472196,472200,475828,481225,486860,490704,491062,494998,495915,495918,496670,496671,496672,497513,497978,498431,498714,500086,500087,500088,500089,500090,500091,500092,500093,500094,500095,500096,500097,500098,500099,500100,500101,500102,500103,500104,500105,500106,500107,500108,500109,500110,500111,500112,500113,500114,500115,500116,500117,500118,500119,500120,501146,501148,501151,501152,501153,501154,502009,502010,502011,503412,518029,518030,518031,518032,518033,518034,518035,518036,518037,518038,518039,518079,518080,518081,518082,518083,518084,518085,518086,518087,518088,518089,518090,518091,518092,518093,518094,518095,520644,520645,520646,520647,520648,522979,527582,535202,535629,535691,548871,548875,550807,550810,551021,551074,564455,569947,570154,591214,591237,593380,593381,593384,593385,593388,613009,619538,619670,621686,621999,635747,635748,635749,635750,635752,635753,635754,636794,636795,636796,636797,636798,636799,636800,636801,636802,636803,636804,636805,636806,636807,636808,636809,636810,636811,636813,636814,636816,636817,636818,636819,641142,642501,649193,650178,650179,650180,650181,650183,650184,650185,656071,662071,667995,668056,668057,669964,669965,669968,669972,669978,673783,678267,679615,687430,693468,693469,693471,693472,693474,700904,700905,700906,700907,702386,702388,702391,702397,702412,706738,709758,711139,718339,719337,721775,723890,723891,723895,725415,725416,726664,735907,740391,740392,740393,741529,741532,760497,762584,762586,762587,762592,762595,762596,762599,762600,762602,762603,762604,762606,762607,762610,763714,763720,763721,763725,771609,780014,780015,780046,780047,787646,789069,789072,789073,789075,789078,789079,789080,789083,789086,789088,790182,796150,799437,799439,804293,804294,804295,804296,804297,804300,814673,814675,814757,815476,815477,815480,815483,815485,816583,816584,816585,827639,827640,827641,827772,838511,840364,843548,843549,849720,849721,849722,849724,849725,849726,849727,849728,849729,849731,856326,856327,856328,856333,856334,858853,860050,873822,894828,894829,894830,894831,894832,894833,894834,894835,894836,904472,904473,904476,904478,914672,914673,914680,914681,914686,917938,919984,919985,921798,929556,929558,929559,931879,931902,942119,956669,958471,958472,958473,958474,958475,958476,958477,958478,958479,958480,960066,964933,966906,971425,972835,977256,985159,991313,994785,996796,998022,1005267,1005268,1005269,1005270,1005272,1005275,1005276,1005277,1005278,1005279,1005282,1005283,1005284,1005285,1005286,1005287,1005288,1005289,1005290,1005291,1009280,1028706,1036309,1036396,1036464,1036466,1036467,1079828,1085685,1085686,1087135,1088224,1088281,1095206,1095207,1095208,1095209,1095210,1095211,1099667,1120761,1120762,1120766,1120767,1120775,1120779,1129076,1129078,1129079,1129080,1129081,1129082,1129083,1129086,1148449,1158261,1158262,1158264,1158266,1158267,1179043,1179044,1179045,1207649,1207650,1207651,1207654,1207658,1207660,1207662,1207663,1207672,1213332,1215157,1215417,1215418,1220293,1224383,1224384,1224385,1224386,1224387,1255206,1273628,1275114,1275115,1275116,1275117,1282328,1288648,1288651,1288652,1313533,1313544,1322465,1324574,1329184,1329185,1329188,1335002,1341427,1344037,1344039,1344040,1344042,1344043,1344044,1344045,1344046,1344048,1344049,1344051,1344052,1344053,1344055,1344057,1344058,1349593,1356107,1356633,1356634,1356636,1356637,1356638,1356640,1356644,1356645,1356647,1356649,1356650,1356651,1356652,1356653,1382602,1387346,1399249,1411686,1411693,1411694,1411696,1411700,1411702,1417953,1417954,1417956,1417958,1417959,1417965,1417966,1432741,1436273,1436275,1436278,1439537,1450317,1450320,1450321,1450322,1450323,1451899,1451900,1451901,1452668,1452672,1452674,1452676,1452677,1452678,1454014,1454015,1454016,1454388,1454389,1460441,1464288,1464289,1472695,1472696,1489590,1489593,1489598,1501545,1505017,1505018,1505026,1505029,1505031,1505134,1509867,1514900,1514901,1514903,1514904,1519467,1533028,1535137,1572114,1582374,1582376,1582377,1582378,1582379,1582380,1582381,1582382,1582383,1582384,1582385,1582386,1582387,1582388,1582389,1582390,1582391,1582392,1582393,1582394,1582395,1582396,1582397,1582398,1582399,1582400,1582401,1582402,1582403,1582404,1582405,1582407,1582408,1582410,1582411,1582412,1582413,1582414,1582416,1582417,1582419,1582420,1582421,1582422,1582423,1582424,1582425,1582426,1582427,1582428,1582429,1582430,1582431,1582432,1582433,1582434,1582435,1582436,1582437,1582438,1600244,1600246,1601763,1623064,1624039,1681182,1681183,1681184,1706456,1706458,1706459,1706461,1706462,1706465,1706471,1706472,1706476,1716284,1716286,1717684,1717685,1722410,1722411,1722413,1722415,1722417,1722418,1722419,1772543,1772591,1772593,1777452];
    for file_id in tqdm(file_ids):
        download_file(file_id, args.output);

if __name__ == "__main__":
    main();
